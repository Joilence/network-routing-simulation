# 实验报告

## 简述

## 设计

### 程序实验流程

- 测试程序接收一个拓扑图或者生成一个拓扑图
- 测试程序根据拓扑图，生成路由器实例，并连接路由器（填写其路由表？）
- 每隔一定时间，记录各个
- 每隔一定时间，改变链路 cost
- 指定一个路由器向另一个路由器发送一个数据包

### 路由器

- 数据成员部分
  - 路由器地址：路由器名称即为其地址
  - LS 算法拓扑图：邻接列表存储
  - 路由表
  - 当前路由模式
- 路由选择部分
  - 定时发包更新路由表
  - 接收地址，返回下一跳路由名称
- IO 部分
  - 发包
  - UDP 监听端口进行收包，拆包
  - *接收到包后，新建线程进行处理
- 中控部分
  - 接收指令，发送一个数据包
- 问题
  - LS 路由表如何更新
  - 如何处理连接
  - 地址相当于端口号？
  - 如何处理链路 down 掉？down 掉之后发包？

### LS 算法机制

每个路由器定时向整个网络广播自己的路由状态。
每个路由器接收到广播包，更新自己的路由表。

### DV 算法机制

每个路由器定时向相邻路由广播自己的路由状态。
每个路由器接收到广播包，更新自己路由表。

### 数据结构

- 数据包
    - src_addr
    - dest_addr
    - protocol: 'ls' | 'dv' | 'msg'
    - msg
- LS 信息
- DV 信息
- 路由表
    - 表项
        - 目标地址
        - 开销
        - 发送端口

### 可视化

#### 数据包日志

建立一个数据包日志目录，每个虚拟机转发数据包时，往该数据包的日志文本文件中，写入相关信息。

如：虚拟机 A 转发数据包 12345，向 12345.md 写入：「源 ip, 目的 ip, 目的主机名」。

12345.md 中最终呈现：

``` text
源 ip，目的 ip，某主机名
源 ip，目的 ip，某主机名
源 ip，目的 ip，某主机名
源 ip，目的 ip，某主机名
源 ip，目的 ip，目的主机名
```

则根据主机名的变化，参照拓扑图可以观察到路径。

#### GUI

## 部署

## 实验结果

